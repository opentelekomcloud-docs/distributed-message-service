:original_name: ListInstances.html

.. _ListInstances:

Listing All Instances
=====================

Function
--------

This API is used to query the instances of an account by the specified conditions.

URI
---

GET /v2/{project_id}/instances

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID.
   ========== ========= ====== ===========

.. table:: **Table 2** Query Parameters

   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Mandatory       | Type            | Description                                                                                                                                                                                                           |
   +==================+=================+=================+=======================================================================================================================================================================================================================+
   | engine           | No              | String          | Message engine. Value: **kafka**.                                                                                                                                                                                     |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name             | No              | String          | Instance name.                                                                                                                                                                                                        |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | instance_id      | No              | String          | Instance ID.                                                                                                                                                                                                          |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status           | No              | String          | Instance status.                                                                                                                                                                                                      |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | include_failure  | No              | String          | Whether to return the number of instances that fail to be created.                                                                                                                                                    |
   |                  |                 |                 |                                                                                                                                                                                                                       |
   |                  |                 |                 | If the value is **true**, the number of instances that failed to be created is returned. If the value is not **true**, the number is not returned.                                                                    |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | exact_match_name | No              | String          | Whether to search for the instance that precisely matches a specified instance name.                                                                                                                                  |
   |                  |                 |                 |                                                                                                                                                                                                                       |
   |                  |                 |                 | The default value is *false*\ \*, indicating that a fuzzy search is performed based on a specified instance name. If the value is **true**, the instance that precisely matches a specified instance name is queried. |
   +------------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

None

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +--------------+-------------------------------------------------------------------------------------+----------------------+
   | Parameter    | Type                                                                                | Description          |
   +==============+=====================================================================================+======================+
   | instances    | Array of :ref:`ShowInstanceResp <listinstances__response_showinstanceresp>` objects | Instance list.       |
   +--------------+-------------------------------------------------------------------------------------+----------------------+
   | instance_num | Integer                                                                             | Number of instances. |
   +--------------+-------------------------------------------------------------------------------------+----------------------+

.. _listinstances__response_showinstanceresp:

.. table:: **Table 4** ShowInstanceResp

   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                     | Type                                                                  | Description                                                                                                                  |
   +===============================+=======================================================================+==============================================================================================================================+
   | name                          | String                                                                | Instance name.                                                                                                               |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | engine                        | String                                                                | Message engine.                                                                                                              |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | engine_version                | String                                                                | Version.                                                                                                                     |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | description                   | String                                                                | Instance description                                                                                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | specification                 | String                                                                | Instance specifications.                                                                                                     |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | storage_space                 | Integer                                                               | Message storage space in GB.                                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | partition_num                 | String                                                                | Number of partitions in a Kafka instance.                                                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | used_storage_space            | Integer                                                               | Used message storage space in GB.                                                                                            |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | connect_address               | String                                                                | IP address of an instance.                                                                                                   |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | port                          | Integer                                                               | Port of an instance.                                                                                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | status                        | String                                                                | Instance status.                                                                                                             |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | instance_id                   | String                                                                | Instance ID.                                                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | resource_spec_code            | String                                                                | Resource specification code.                                                                                                 |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **dms.instance.kafka.cluster.c3.mini**: Kafka instance with 100 MB/s bandwidth                                            |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **dms.instance.kafka.cluster.c3.small.2**: Kafka instance with 300 MB/s bandwidth                                         |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **dms.instance.kafka.cluster.c3.middle.2**: Kafka instance with 600 MB/s bandwidth                                        |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **dms.instance.kafka.cluster.c3.high.2**: Kafka instance with 1200 MB/s bandwidth                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | vpc_id                        | String                                                                | VPC ID.                                                                                                                      |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | vpc_name                      | String                                                                | VPC name.                                                                                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | created_at                    | String                                                                | Time when the instance was created.                                                                                          |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | The time is in the format of timestamp, that is, the offset milliseconds from 1970-01-01 00:00:00 UTC to the specified time. |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | subnet_name                   | String                                                                | Subnet name.                                                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | subnet_cidr                   | String                                                                | Subnet CIDR block.                                                                                                           |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | user_id                       | String                                                                | User ID.                                                                                                                     |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | user_name                     | String                                                                | Username.                                                                                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | access_user                   | String                                                                | Username for accessing the instance.                                                                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | maintain_begin                | String                                                                | Time at which the maintenance time window starts. The format is HH:mm:ss.                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | maintain_end                  | String                                                                | Time at which the maintenance time window ends. The format is HH:mm:ss.                                                      |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | enable_publicip               | Boolean                                                               | Whether public access is enabled for the instance.                                                                           |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **true**: enabled                                                                                                         |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **false**: disabled                                                                                                       |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | ssl_enable                    | Boolean                                                               | Whether security authentication is enabled.                                                                                  |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **true**: enable                                                                                                          |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **false**: disabled                                                                                                       |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | ssl_two_way_enable            | Boolean                                                               | Indicates whether to enable two-way authentication.                                                                          |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | enable_auto_topic             | Boolean                                                               | Whether automatic topic creation is enabled.                                                                                 |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **true**: enabled                                                                                                         |
   |                               |                                                                       |                                                                                                                              |
   |                               |                                                                       | -  **false**: disabled                                                                                                       |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | type                          | String                                                                | Instance type. The value can be **cluster**.                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | product_id                    | String                                                                | Product ID.                                                                                                                  |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | security_group_id             | String                                                                | Security group ID.                                                                                                           |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | security_group_name           | String                                                                | Security group name.                                                                                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | subnet_id                     | String                                                                | Subnet ID.                                                                                                                   |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | available_zones               | Array of strings                                                      | AZ to which the instance brokers belong. The AZ ID is returned.                                                              |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | total_storage_space           | Integer                                                               | Message storage space in GB.                                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | public_connect_address        | String                                                                | Instance public access address. This parameter is available only when public access is enabled for the instance.             |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | storage_resource_id           | String                                                                | Storage resource ID.                                                                                                         |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | storage_spec_code             | String                                                                | I/O specifications.                                                                                                          |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | service_type                  | String                                                                | Service type.                                                                                                                |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | storage_type                  | String                                                                | Storage class.                                                                                                               |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | retention_policy              | String                                                                | Message retention policy.                                                                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | kafka_public_status           | String                                                                | Whether public access is enabled for Kafka.                                                                                  |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | public_bandwidth              | Integer                                                               | Public network access bandwidth.                                                                                             |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | cross_vpc_info                | String                                                                | Cross-VPC access information.                                                                                                |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | rest_connect_address          | String                                                                | Kafka REST connection address.                                                                                               |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | public_boundwidth             | Integer                                                               | Public network access bandwidth. To be deleted.                                                                              |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | message_query_inst_enable     | Boolean                                                               | Whether message query is enabled.                                                                                            |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | vpc_client_plain              | Boolean                                                               | Whether intra-VPC plaintext access is enabled.                                                                               |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | support_features              | String                                                                | List of features supported by the Kafka instance.                                                                            |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | pod_connect_address           | String                                                                | Connection address on the tenant side.                                                                                       |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | disk_encrypted                | Boolean                                                               | Whether disk encryption is enabled.                                                                                          |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | disk_encrypted_key            | String                                                                | Disk encryption key. If disk encryption is not enabled, this parameter is left blank.                                        |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | kafka_private_connect_address | String                                                                | Private connection address of a Kafka instance.                                                                              |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | public_access_enabled         | String                                                                | Time when public access was enabled for an instance. The value can be **true**, **actived**, **closed**, or **false**.       |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | node_num                      | Integer                                                               | Node quantity.                                                                                                               |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | enable_acl                    | Boolean                                                               | Indicates whether access control is enabled.                                                                                 |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | broker_num                    | Integer                                                               | Broker quantity.                                                                                                             |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | tags                          | Array of :ref:`TagEntity <listinstances__response_tagentity>` objects | Tag list.                                                                                                                    |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+
   | dr_enable                     | Boolean                                                               | Indicates whether DR is enabled.                                                                                             |
   +-------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------+

.. _listinstances__response_tagentity:

.. table:: **Table 5** TagEntity

   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                          |
   +=======================+=======================+======================================================================================================+
   | key                   | String                | Tag key, which can contain a maximum of 36 Unicode characters.                                       |
   |                       |                       |                                                                                                      |
   |                       |                       | The key cannot be left blank or be an empty string.                                                  |
   |                       |                       |                                                                                                      |
   |                       |                       | It cannot contain nonprintable ASCII (0-31) characters and the following special characters: =*<>,|/ |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------+
   | value                 | String                | Tag value, which can contain a maximum of 43 Unicode characters.                                     |
   |                       |                       |                                                                                                      |
   |                       |                       | The value cannot be left blank or be an empty string.                                                |
   |                       |                       |                                                                                                      |
   |                       |                       | It cannot contain nonprintable ASCII (0-31) characters and the following special characters: =*<>,|/ |
   +-----------------------+-----------------------+------------------------------------------------------------------------------------------------------+

Example Requests
----------------

.. code-block:: text

   GET https://{endpoint}/v2/{project_id}/instances

Example Responses
-----------------

**Status code: 200**

All instances are listed successfully.

.. code-block::

   {
     "instances" : [ {
       "name" : "kafka-2085975099",
       "engine" : "kafka",
       "port" : 9092,
       "status" : "RUNNING",
       "type" : "cluster",
       "specification" : "100MB",
       "engine_version" : "1.1.0",
       "connect_address" : "192.168.0.100,192.168.0.61,192.168.0.72",
       "instance_id" : "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
       "resource_spec_code" : "dms.instance.kafka.cluster.c3.mini",
       "charging_mode" : 1,
       "vpc_id" : "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
       "vpc_name" : "dms-test",
       "created_at" : "1585618587087",
       "product_id" : "00300-30308-0--0",
       "security_group_id" : "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
       "security_group_name" : "Sys-default",
       "subnet_id" : "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
       "available_zones" : [ "38b0f7a602344246bcb0da47b5d548e7" ],
       "user_id" : "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
       "user_name" : "paas_dms",
       "kafka_manager_user" : "root",
       "maintain_begin" : "02:00:00",
       "maintain_end" : "06:00:00",
       "enable_log_collection" : false,
       "storage_space" : 492,
       "total_storage_space" : 600,
       "used_storage_space" : 25,
       "partition_num" : "300",
       "enable_publicip" : false,
       "ssl_enable" : false,
       "management_connect_address" : "https://192.168.0.100:9999",
       "cross_vpc_info" : "{\"192.168.0.61\":{\"advertised_ip\":\"192.168.0.61\",\"port\":9011,\"port_id\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"},\"192.168.0.72\":{\"advertised_ip\":\"192.168.0.72\",\"port\":9011,\"port_id\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"},\"192.168.0.100\":{\"advertised_ip\":\"192.168.0.100\",\"port\":9011,\"port_id\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"}}",
       "storage_resource_id" : "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
       "storage_spec_code" : "dms.physical.storage.ultra",
       "service_type" : "advanced",
       "storage_type" : "hec",
       "enterprise_project_id" : "0",
       "is_logical_volume" : true,
       "extend_times" : 0,
       "retention_policy" : "produce_reject",
       "ipv6_enable" : false,
       "ipv6_connect_addresses" : [ ],
       "connector_enable" : false,
       "connector_id" : "",
       "rest_enable" : false,
       "rest_connect_address" : "",
       "kafka_public_status" : "closed",
       "public_boundwidth" : 0,
       "message_query_inst_enable" : true,
       "vpc_client_plain" : false,
       "support_features" : "kafka.new.pod.port,feature.physerver.kafka.topic.modify,feature.physerver.kafka.topic.accesspolicy,message_trace_enable,features.pod.token.access,feature.physerver.kafka.pulbic.dynamic,roma_app_enable,features.log.collection,auto_topic_switch,feature.physerver.kafka.user.manager",
       "trace_enable" : false,
       "agent_enable" : false,
       "pod_connect_address" : "100.86.75.15:9080,100.86.142.77:9080,100.86.250.167:9080",
       "disk_encrypted" : false,
       "kafka_private_connect_address" : "192.168.0.61:9092,192.168.0.100:9092,192.168.0.72:9092",
       "enable_auto_topic" : false,
       "ces_version" : "linux"
     } ],
     "instance_num" : 1
   }

Status Codes
------------

=========== ======================================
Status Code Description
=========== ======================================
200         All instances are listed successfully.
=========== ======================================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
